(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[164],{8311:function(e,a,s){Promise.resolve().then(s.bind(s,6190))},6190:function(e,a,s){"use strict";s.r(a),s.d(a,{default:function(){return l}});var r=s(7437),t=s(2265),n=s(9376),c=s(3464);function i(){let e=(0,n.useSearchParams)().get("imageId"),[a,s]=(0,t.useState)(null),[i,l]=(0,t.useState)([]),[o,d]=(0,t.useState)(!1),[m,x]=(0,t.useState)(null),[u,g]=(0,t.useState)(!0);(0,t.useEffect)(()=>{fetch("./setup.json").then(e=>e.json()).then(e=>s(e)).catch(e=>{console.error("Error loading config:",e)})},[]),(0,t.useEffect)(()=>{a&&e&&h(e,a)},[e,a]);let h=(e,a)=>{let s=indexedDB.open("ImageStorageDB",1);s.onsuccess=()=>{let r=s.result.transaction("images","readonly").objectStore("images").get(e);r.onsuccess=async()=>{if(r.result){let e=r.result.data;x(e),g(!1),await f(e,a)}else console.warn("No image found in IndexedDB with ID:",e),l([])},r.onerror=()=>{console.error("Error retrieving image from IndexedDB.")}},s.onerror=()=>{console.error("Failed to access IndexedDB.")}},f=async(e,a)=>{d(!0),l([]);try{let{data:s}=await c.Z.post(a.imageApiUrl,{image:e},{headers:{"Content-Type":"application/json",Accept:"application/json"},withCredentials:!1});if((null==s?void 0:s.similar_images)&&Array.isArray(s.similar_images)){let e=s.similar_images.map((e,a)=>({src:e,alt:"Similar Image ".concat(a+1)}));l(e)}else console.error("Unexpected API response format:",s),l([])}catch(e){console.error("API request failed:",e),l([])}finally{d(!1)}};return a?(0,r.jsxs)("div",{className:"min-h-screen ".concat(a.appBackground," ").concat(a.textColor),children:[(0,r.jsx)("header",{className:"border-b shadow ".concat(a.borderColor),children:(0,r.jsx)("div",{className:"mx-auto max-w-7xl px-4 py-6 sm:px-6 lg:px-8",children:(0,r.jsx)("h1",{className:"text-3xl font-bold ".concat(a.headingColor),children:"Image Gallery"})})}),(0,r.jsx)("main",{children:(0,r.jsxs)("div",{className:"mx-auto max-w-7xl py-6 sm:px-6 lg:px-8",children:[(0,r.jsx)("h2",{className:"mb-2 ml-4 text-xl font-semibold ".concat(a.headingColor),children:"Queried image"}),u?(0,r.jsx)("p",{children:"Loading input image..."}):m?(0,r.jsx)("div",{className:"mx-auto flex h-[200px] w-[300px] items-center justify-center overflow-hidden rounded-xl",children:(0,r.jsx)("img",{src:m,alt:"Captured",className:"h-40 w-60 rounded-md object-cover ".concat(a.cardBackground)})}):(0,r.jsx)("p",{children:"No image found."}),o&&(0,r.jsx)("div",{className:"text-center ".concat(a.textColor),children:"Searching for similar images..."}),i.length>0&&(0,r.jsxs)("div",{children:[(0,r.jsx)("h2",{className:"mb-4 ml-4 text-xl font-semibold ".concat(a.headingColor),children:"Similar Images"}),(0,r.jsx)("div",{className:"grid grid-cols-2 gap-4 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5",children:i.map(e=>(0,r.jsx)("img",{src:e.src,alt:e.alt,className:"h-40 w-full rounded-md object-cover ".concat(a.cardBackground)},e.src))})]}),!o&&0===i.length&&(0,r.jsx)("div",{className:"text-center text-gray-500",children:"No similar images found."})]})})]}):(0,r.jsx)("div",{className:"text-center text-white",children:"Loading config..."})}function l(){return(0,r.jsx)(t.Suspense,{fallback:(0,r.jsx)("div",{className:"text-center text-white",children:"Loading..."}),children:(0,r.jsx)(i,{})})}}},function(e){e.O(0,[73,971,117,744],function(){return e(e.s=8311)}),_N_E=e.O()}]);